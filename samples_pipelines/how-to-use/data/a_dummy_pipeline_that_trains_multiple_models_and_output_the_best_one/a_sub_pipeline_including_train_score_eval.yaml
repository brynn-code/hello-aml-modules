$schema: http://azureml/sdk-2-0/PipelineModule.json
type: PipelineModule
name: A sub pipeline including train/score/eval
description: train model and evaluate model perf
is_primary: false
inputs:
  input_data:
    default:
    type: Any
  test_data:
    default:
    type: Any
  learning_rate:
    default:
    type: Any
outputs:
  eval_output:
    mode: mount
  model_output:
    mode: mount
graph:
  MPI Train-f603dea4:
    $ref: modules/mpi_train.yaml
    inputs:
      training_data:
        $ref: inputs/input_data
      max_epochs: 5
      learning_rate:
        $ref: inputs/learning_rate
    outputs:
      model_output:
        mode: mount
    runsettings:
      node_count: 2
      process_count_per_node: 2
  Score-9afa682f:
    $ref: modules/score.yaml
    inputs:
      model_input:
        $ref: MPI Train-f603dea4/model_output
      test_data:
        $ref: inputs/test_data
    outputs:
      score_output:
        mode: mount
  Evaluate-9ac3f118:
    $ref: modules/evaluate.yaml
    inputs:
      scoring_result:
        $ref: Score-9afa682f/score_output
    outputs:
      eval_output:
        mode: mount
